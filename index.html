<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Descargar RU</title>

<style>
body{
    margin:0;
    font-family: Arial, sans-serif;
    background:white;
    color:#BC0032;
    display:flex;
    flex-direction:column;
    min-height:100vh;
}

.main{
    flex:1;
    display:flex;
    flex-direction:column;
    justify-content:center;
    align-items:center;
    text-align:center;
}

img{
    width:220px;
    height:220px;
    object-fit:cover;
    border:4px solid #BC0032;
    margin-bottom:30px;
}

button{
    background:white;
    color:#BC0032;
    border:3px solid #BC0032;
    padding:14px 30px;
    font-size:16px;
    cursor:pointer;
    transition:0.3s;
}

button:hover{
    background:#BC0032;
    color:white;
}

footer{
    border-top:2px solid #BC0032;
    padding:15px;
    text-align:center;
    font-size:14px;
}
</style>
</head>
<body>

<div class="main">

    <img src="ECOLOGO.jpeg" alt="App Logo">

    <h2 id="info">Cargando última versión...</h2>

    <button id="downloadBtn" disabled>
        Descargar
    </button>

</div>

<footer>
    Contáctenos: cbtis179.dir@uemstis.sems.gob.mx
</footer>

<script>
async function obtenerUltimaVersion() {

    const token = "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";

    try {

        const response = await fetch(
            "https://api.github.com/repos/RMSOFF/RU/contents/updates.json",
            {
                headers: {
                    "Authorization": "token " + token,
                    "Accept": "application/vnd.github.v3.raw"
                }
            }
        );

        const data = await response.json();
        const ultima = data[0];

        document.getElementById("info").innerText =
            "Versión " + ultima.versionString;

        const btn = document.getElementById("downloadBtn");
        btn.disabled = false;

        btn.onclick = function(){
            window.location.href = ultima.apkUrl;
        };

    } catch(error) {
        document.getElementById("info").innerText =
            "Error al cargar la versión.";
        console.error(error);
    }
}

obtenerUltimaVersion();
</script>

</body>
</html>